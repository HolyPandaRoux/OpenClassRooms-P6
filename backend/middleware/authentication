
/*This middleware function is used to check if the user is authenticated or not. If the user is authenticated, then the user can perform the CRUD operations on the posts. If the user is not authenticated, then the user cannot perform the CRUD operations on the posts.*/
const jwt = require("jsonwebtoken");


/*The above code is a middleware function that checks if the user is authenticated.*/
module.exports = (req, res, next) => {
    try {
        const token = req.headers.authorization.split(" ")[1];
        const decodedToken = jwt.verify(token, process.env.JWT);
        const userId = decodedToken.userId;
        if (req.body.userId && req.body.userId !== userId) {
            throw "Invalid user ID";
        } else {
            next();
        }
    } catch {
        res.status(401).json({
            error: new Error("Invalid request!"),
        });
    }
};